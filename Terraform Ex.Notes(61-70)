TERRAFORM NOTES

61. Data source - FORMAT
-------------------------
Using the data source block we can fetch a particular instance. Look for the details of this in the AWS Resource -> Documentation panel. 
Data source uses tags, which are very important to maintain a large environment with 1000s of instances. 

Ask @need to research on the usecases, apart from update, environment seggregation and network related changes, can there be any use of this on Application deployment ? 

data "aws_instance" "foo" {
instance_id = "i-instance-id" 
}

filter{
name = "image-id"
values = ["ami-xxxxxx"]
}

filter{
name = "tag:name"
values = ["instance-name-tag] 
} 

62. Usecase = Problem Definition :Fetch the latest OS image using Data Source
------------------------------------------------------------------------------
* Avoid hard coded static values in Terraform code. 
Use terraform to query the latest OS image and using that to create an instance. 

63. Usecase: Solution
-----------------------
could not find the os_release | ami_id | latest_patch in the Azure Resource block, not able to convert this for Azure. 

64. Debugging in TERRAFORM 
---------------------------

40% of time will go into Debugging. Documentation / config issue. 
-- Always maintain a detailed log. 
Enable TF_LOG in Terraform 

Store the file in TF_LOG_PATH 

Logs in the decreasing number of verbosity : 
TRACE
DEBUG
INFO
WARN
ERROR 

65 - TERRAFORM Debug setup 
---------------------------
> set TF_LOG = INFRO | TRACE  ( Windows) 
> export TF_LOG = TRACE ( Linux) 

Where is it storing these logs ? 
export TF_LOG_PATH=/temp/terraform-%date%.log

When we use "SET" its session dependent, it would disappear in the next session. 

66 - TERRAFORM Debugging Model : Types of errors cause
------------------------------------------------------
1. Language Errors: Syntax error in cfg
2. State Error: locked statefile, out of sync etc
3. CORE Error : Related with the bugs in Terraform -- keep an eye on the github repos on the open issues. label = bug  
4. PROVIDER Error: Issue with the provider plugin, could even report the issue. terraform-provider-azure | terraform-provider-aws in GIT 

67. Report bugs in the Terraform github repository - create an issue -> bug report -> details 

68. Use terraform fmt command for the formatting the right indentation. 

69. Load order and Semantics
------------------------------
provider.tf 
variable.tf 
semantics.tf 
iam_users.tf 

Its better to divide the production code with different blocks. And when we run terraform plan, it all comes together

70. Terraform Dynamic Block
-----------------------------








































































































































































